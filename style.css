/* =========================================
   STYLE.CSS - INTELLIGENCE ACADEMY EDITION
   ========================================= */

:root {
    /* الثيم الافتراضي (بلازما) */
    --bg-main: radial-gradient(circle at center, #1a1c29 0%, #050505 100%);
    --primary-grad: linear-gradient(135deg, #FF4D4D, #F9D423); /* برتقالي */
    --secondary-grad: linear-gradient(135deg, #00C9FF, #92FE9D); /* سماوي */
    --accent-glow: #ffd700;
    --glass-bg: rgba(255, 255, 255, 0.05);
    --glass-border: rgba(255, 255, 255, 0.1);
    --font-main: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    
    /* ألوان القدرات */
    --color-nuke: #ff4444;
    --color-freeze: #00ffff;
    --color-hack: #00ff00;
}

/* ثيمات إضافية */
body.theme-matrix {
    --bg-main: #000000;
    --primary-grad: linear-gradient(135deg, #00FF00, #004400);
    --secondary-grad: linear-gradient(135deg, #00cc00, #ccffcc);
    --accent-glow: #00FF00;
    font-family: 'Courier New', monospace;
}
body.theme-royal {
    --bg-main: radial-gradient(circle, #2E003E 0%, #000000 100%);
    --primary-grad: linear-gradient(135deg, #FFD700, #B8860B);
    --secondary-grad: linear-gradient(135deg, #9400D3, #4B0082);
    --accent-glow: #FFD700;
}

* { box-sizing: border-box; margin: 0; padding: 0; user-select: none; outline: none; -webkit-tap-highlight-color: transparent; }

body {
    background: var(--bg-main); color: #fff; font-family: var(--font-main);
    height: 100dvh; overflow: hidden; direction: rtl; text-align: center;
    transition: background 0.5s ease;
}

.hidden { display: none !important; }
.theme-text { background: var(--primary-grad); -webkit-background-clip: text; background-clip: text; color: transparent; font-weight: 900; }

/* -------------------------------------------
   1. الهيكل العام والطبقات
   ------------------------------------------- */
.full-screen-layer {
    position: fixed; inset: 0; display: flex; justify-content: center; align-items: center;
    z-index: 2000; background: rgba(0, 0, 0, 0.85); backdrop-filter: blur(12px);
}

.glass-card {
    background: var(--glass-bg); backdrop-filter: blur(20px); border: 1px solid var(--glass-border);
    box-shadow: 0 20px 50px rgba(0,0,0,0.5); padding: 25px; border-radius: 20px;
    width: min(90%, 500px); position: relative;
}

#app-content {
    height: 100%; display: flex; flex-direction: column;
    /* التعديل المهم للتوسيط ومنع التداخل */
    justify-content: flex-start; 
    align-items: center;
    padding-top: 70px; /* مساحة للـ HUD */
    overflow-y: auto;
}

/* -------------------------------------------
   2. القائمة واختيار الأنماط (الشبكة الجديدة)
   ------------------------------------------- */
#main-menu {
    width: 100%; max-width: 800px; padding: 20px;
    display: flex; flex-direction: column; align-items: center;
    flex-grow: 1; justify-content: center;
}

.modes-grid {
    display: grid; 
    grid-template-columns: repeat(2, 1fr); /* عمودين */
    gap: 15px; width: 100%; margin: 20px 0;
}

.mode-card {
    background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.1);
    border-radius: 15px; padding: 15px; cursor: pointer; position: relative;
    transition: 0.3s; overflow: hidden; min-height: 120px;
    display: flex; flex-direction: column; align-items: center; justify-content: center;
    text-align: center;
}

/* النمط المميز (المستطيل الكبير في الأعلى) */
.featured-mode {
    grid-column: span 2; /* يأخذ العرض كامل */
    background: linear-gradient(45deg, rgba(255,255,255,0.05), rgba(255,255,255,0.01));
    border: 1px solid var(--accent-glow);
    min-height: 140px;
}
.featured-mode .mode-content { display: flex; align-items: center; gap: 20px; }
.featured-mode .mode-icon { font-size: 3rem; }
.featured-mode .mode-info { text-align: right; }
.featured-mode h2 { font-size: 1.5rem; margin-bottom: 5px; color: #fff; }
.featured-mode p { color: #ccc; font-size: 0.9rem; }

.mode-card:hover { transform: translateY(-3px); background: rgba(255,255,255,0.08); border-color: #fff; }
.mode-card.active-card { border-color: var(--accent-glow); box-shadow: 0 0 20px rgba(255,255,255,0.1); }
.mode-card h3 { font-size: 1.1rem; margin: 10px 0 5px; }
.mode-card p { font-size: 0.8rem; color: #888; }

/* -------------------------------------------
   3. ساحة اللعب والأسلحة
   ------------------------------------------- */
#game-container {
    flex-grow: 1; display: flex; flex-direction: column; 
    justify-content: center; align-items: center; width: 100%;
}

.game-wrapper {
    display: flex; gap: 20px; align-items: flex-start;
    flex-wrap: wrap; justify-content: center;
}

/* شريط القدرات (الجانبي) */
.power-ups-bar {
    display: flex; flex-direction: column; gap: 15px;
    background: rgba(0,0,0,0.4); padding: 15px; border-radius: 15px;
    border: 1px solid rgba(255,255,255,0.05);
}
.power-item { display: flex; flex-direction: column; align-items: center; gap: 5px; font-size: 0.7rem; color: #aaa; position: relative; }
.power-btn {
    width: 50px; height: 50px; border-radius: 12px; border: none; font-size: 1.5rem; cursor: pointer;
    background: rgba(255,255,255,0.1); transition: 0.2s;
}
.power-count {
    position: absolute; top: -5px; right: -5px; background: #fff; color: #000;
    border-radius: 50%; width: 20px; height: 20px; font-weight: bold; display: flex; justify-content: center; align-items: center;
}
.btn-nuke:hover { color: var(--color-nuke); box-shadow: 0 0 15px var(--color-nuke); }
.btn-freeze:hover { color: var(--color-freeze); box-shadow: 0 0 15px var(--color-freeze); }
.btn-hack:hover { color: var(--color-hack); box-shadow: 0 0 15px var(--color-hack); }

/* رقعة اللعب */
#game-arena {
    display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px;
    width: min(95vw, 450px); aspect-ratio: 1/1;
}

.sub-grid {
    display: grid; grid-template-columns: repeat(3, 1fr); gap: 2px; padding: 4px;
    background: rgba(0, 0, 0, 0.4); border-radius: 8px;
    border: 2px solid rgba(255, 255, 255, 0.1); /* إطار عادي */
    transition: 0.3s;
}
.sub-grid.active-zone {
    border-color: var(--accent-glow); opacity: 1;
    box-shadow: 0 0 20px rgba(255, 215, 0, 0.15);
}
.sub-grid:not(.active-zone) { opacity: 0.5; }

.cell {
    background: rgba(255, 255, 255, 0.08); border-radius: 4px; cursor: pointer;
    display: flex; justify-content: center; align-items: center; font-size: 1.4rem;
    font-weight: bold; aspect-ratio: 1/1; border: 1px solid rgba(255,255,255,0.05);
}
.cell:hover { background: rgba(255, 255, 255, 0.2); }
.cell.x-marked { color: #ff6b6b; text-shadow: 0 0 8px currentColor; }
.cell.o-marked { color: #4facfe; text-shadow: 0 0 8px currentColor; }

/* الختم الكبير */
.sub-grid.won-x::after, .sub-grid.won-o::after {
    position: absolute; inset: 0; display: flex; justify-content: center; align-items: center;
    font-size: 7rem; font-weight: 900; z-index: 10; animation: stamp 0.3s cubic-bezier(0.5, 0, 0.5, 1.5);
}
.sub-grid.won-x::after { content: attr(data-winner); color: rgba(255, 77, 77, 0.9); }
.sub-grid.won-o::after { content: attr(data-winner); color: rgba(0, 201, 255, 0.9); }
@keyframes stamp { 0% { transform: scale(2); opacity: 0; } 100% { transform: scale(1); opacity: 1; } }

/* -------------------------------------------
   4. الإعدادات (التصميم الجديد)
   ------------------------------------------- */
.settings-box { width: min(95%, 600px); max-height: 90vh; overflow-y: auto; text-align: right; }
.settings-box h2 { text-align: center; margin-bottom: 20px; }
.settings-section { margin-bottom: 25px; padding-bottom: 15px; border-bottom: 1px solid rgba(255,255,255,0.1); }
.settings-section h3 { font-size: 1rem; color: #aaa; margin-bottom: 15px; }

.players-config { display: flex; justify-content: space-between; align-items: center; gap: 10px; }
.p-config { flex: 1; display: flex; flex-direction: column; gap: 10px; }
.input-minimal { background: transparent; border: none; border-bottom: 1px solid #555; color: #fff; padding: 5px; text-align: center; width: 100%; }
.input-minimal:focus { border-color: #fff; }

.avatar-selector { display: flex; gap: 5px; justify-content: center; }
.av-opt { width: 35px; height: 35px; border-radius: 50%; background: rgba(255,255,255,0.1); display: flex; justify-content: center; align-items: center; cursor: pointer; border: 2px solid transparent; }
.av-opt.selected { border-color: var(--accent-glow); background: rgba(255,255,255,0.2); }

.theme-selector { display: flex; gap: 10px; }
.theme-opt { flex: 1; background: rgba(255,255,255,0.05); padding: 10px; border-radius: 10px; cursor: pointer; text-align: center; border: 1px solid transparent; }
.theme-opt.selected { border-color: var(--accent-glow); background: rgba(255,255,255,0.1); }
.color-preview { width: 20px; height: 20px; border-radius: 50%; margin: 0 auto 5px; }
.theme-plasma .color-preview { background: linear-gradient(135deg, #FF4D4D, #F9D423); }
.theme-matrix .color-preview { background: #00FF00; }
.theme-royal .color-preview { background: #FFD700; }

.timer-selector { display: flex; gap: 10px; }
.timer-opt { flex: 1; padding: 10px; border-radius: 20px; background: rgba(255,255,255,0.05); text-align: center; cursor: pointer; }
.timer-opt.selected { background: var(--accent-glow); color: #000; font-weight: bold; }

/* -------------------------------------------
   5. HUD والعناصر الأخرى
   ------------------------------------------- */
.hud-bar {
    position: fixed; top: 0; left: 0; right: 0; height: 60px;
    background: rgba(0,0,0,0.8); backdrop-filter: blur(10px);
    border-bottom: 1px solid rgba(255,255,255,0.1);
    display: flex; justify-content: space-between; align-items: center; padding: 0 15px; z-index: 1000;
}
.hud-player { display: flex; align-items: center; gap: 8px; opacity: 0.6; }
.hud-player.active-turn { opacity: 1; transform: scale(1.05); }
.hud-avatar { width: 35px; height: 35px; border-radius: 50%; background: #333; display: flex; justify-content: center; align-items: center; font-weight: bold; border: 2px solid #555; }
.p-x .hud-avatar { border-color: #ff6b6b; color: #ff6b6b; }
.p-o .hud-avatar { border-color: #4facfe; color: #4facfe; }

.btn-primary { background: var(--primary-grad); border: none; padding: 10px 30px; border-radius: 50px; color: #000; font-weight: bold; cursor: pointer; transition: 0.2s; }
.btn-primary:hover { transform: scale(1.05); box-shadow: 0 0 20px rgba(255, 200, 0, 0.4); }
.btn-icon-small { background: transparent; border: none; font-size: 1.2rem; cursor: pointer; width: 40px; }
.btn-text { background: transparent; border: none; color: #aaa; cursor: pointer; text-decoration: underline; margin-top: 10px; }

/* التعليمات */
.tabs-header { display: flex; border-bottom: 1px solid rgba(255,255,255,0.1); margin-bottom: 15px; }
.tab-btn { flex: 1; background: transparent; border: none; color: #888; padding: 10px; cursor: pointer; }
.tab-btn.active { color: #fff; border-bottom: 2px solid var(--accent-glow); }
.tab-content ul { padding-right: 20px; text-align: right; line-height: 1.6; }
.power-desc { display: flex; gap: 10px; align-items: center; text-align: right; margin-bottom: 10px; background: rgba(255,255,255,0.05); padding: 10px; border-radius: 10px; }
.power-desc .icon { font-size: 1.5rem; }

/* الموبايل */
@media (max-width: 600px) {
    .modes-grid { grid-template-columns: 1fr; } 
    .featured-mode { grid-column: auto; }
    .game-wrapper { flex-direction: column; align-items: center; }
    .power-ups-bar { flex-direction: row; width: 100%; justify-content: space-around; }
}
