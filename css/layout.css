/* =========================================
   ğŸ“ LAYOUT SYSTEM (FINAL UPDATED)
   Ø§Ù„Ù‡ÙŠÙƒÙ„ØŒ Ø§Ù„ØªÙ…Ø±ÙƒØ²ØŒ ÙˆØ§Ù„Ø´Ø¨ÙƒØ© Ø§Ù„Ø«Ø§Ø¨ØªØ©
   ========================================= */

body {
    margin: 0; padding: 0;
    width: 100vw; height: 100vh;
    background-color: var(--bg-dark);
    color: var(--text-main);
    font-family: var(--font-ui);
    display: flex; justify-content: center; align-items: center;
    overflow: hidden;
}

/* 1. Ø§Ù„Ø­Ø§ÙˆÙŠØ© Ø§Ù„Ø²Ø¬Ø§Ø¬ÙŠØ© Ø§Ù„ÙƒØ¨ÙŠØ±Ø© */
.glass-stage {
    position: relative;
    width: 95%; max-width: 1100px;
    height: 90vh;
    background: var(--bg-panel);
    border: 1px solid var(--border-color);
    box-shadow: 0 0 50px rgba(0,0,0,0.6);
    border-radius: 12px;
    overflow: hidden; 
    display: flex; flex-direction: column;
}

/* 2. Ù†Ø¸Ø§Ù… Ø§Ù„Ø·Ø¨Ù‚Ø§Øª (Screens) */
.screen {
    position: absolute; inset: 0;
    width: 100%; height: 100%;
    background: var(--bg-panel);
    display: flex; flex-direction: column;
    z-index: 10;
    opacity: 0; pointer-events: none;
    transition: opacity 0.3s ease;
    padding: 20px;
    box-sizing: border-box;
}
.screen.active { opacity: 1; pointer-events: all; z-index: 20; }
.center-flex { justify-content: center; align-items: center; text-align: center; }

/* 3. Ø§Ù„Ù†ÙˆØ§ÙØ° Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø© (Modal Overlay) */
.modal-overlay {
    position: fixed; top: 0; left: 0;
    width: 100vw; height: 100vh;
    background: rgba(0, 0, 0, 0.85);
    backdrop-filter: blur(5px);
    z-index: 1000;
    display: flex; justify-content: center; align-items: center;
    opacity: 0; pointer-events: none;
    transition: opacity 0.3s ease;
}
.modal-overlay:not(.hidden) { opacity: 1; pointer-events: all; }

/* 4. ØªØ®Ø·ÙŠØ· ØµÙØ­Ø© Ø§Ù„Ø£Ù†Ù…Ø§Ø· */
.modes-grid-layout {
    display: grid; grid-template-columns: 1fr 1fr;
    gap: 15px; width: 100%; max-width: 500px; margin: 0 auto;
}
.mode-card.span-2 { grid-column: span 2; }
.mode-card {
    display: flex; flex-direction: column; align-items: center; justify-content: center; gap: 10px;
}

/* 5. ØªØ®Ø·ÙŠØ· Ø³Ø§Ø­Ø© Ø§Ù„Ù„Ø¹Ø¨ ÙˆØ§Ù„Ù‡ÙŠØ¯Ø± (Ù…Ø­Ø¯Ø«) */
.game-header {
    width: 100%;
    display: grid;
    grid-template-columns: 1fr 2fr 1fr; /* ÙŠØ³Ø§Ø± - ÙˆØ³Ø· - ÙŠÙ…ÙŠÙ† */
    align-items: center;
    padding: 0 20px;
    margin-bottom: 10px;
    border-bottom: 1px solid #333;
    background: rgba(0,0,0,0.3);
    min-height: 50px;
}
#btn-back { justify-self: start; }
.turn-display { justify-self: center; text-align: center; width: 100%; }
.score-board { justify-self: end; font-family: var(--font-tech); font-size: 1.2rem; }

.arena-container {
    display: flex; align-items: center; justify-content: center;
    gap: 20px; height: 100%; width: 100%;
}
.side-panel {
    width: 100px; display: flex; flex-direction: column;
    align-items: center; gap: 15px;
}
.grid-wrapper { display: flex; justify-content: center; align-items: center; }

/* 6. Ø§Ù„Ø´Ø¨ÙƒØ© Ø§Ù„Ø«Ø§Ø¨ØªØ© (Rigid Grid System) */
.fixed-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    width: var(--arena-size);
    height: var(--arena-size);
    gap: 5px;
    background: #000;
    padding: 5px;
    border-radius: 8px;
    /* ØªØ«Ø¨ÙŠØª Ø§Ù„Ø£Ø¨Ø¹Ø§Ø¯ */
    min-width: var(--arena-size);
    max-width: var(--arena-size);
}

.sub-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 1px;
    background: #333;
    width: 100%; height: 100%;
    border-radius: 4px; overflow: hidden;
}

.cell {
    background: #121214;
    display: flex; align-items: center; justify-content: center;
    position: relative;
    overflow: hidden; /* ÙŠÙ‚Ø·Ø¹ Ø£ÙŠ ØµÙˆØ±Ø© ØªØ®Ø±Ø¬ Ø¹Ù† Ø§Ù„Ø­Ø¯ÙˆØ¯ */
    width: 100%; height: 100%;
    cursor: pointer;
    user-select: none;
}
.cell:hover { background: #1f1f25; }

/* ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø¯Ø§Ø®Ù„ Ø§Ù„Ø®Ù„ÙŠØ© */
.cell img, .cell span {
    max-width: 70%; 
    max-height: 70%;
    pointer-events: none;
    display: block;
}
.cell span { font-size: 1.8rem; font-weight: bold; line-height: 1; }

/* Ø§Ù„Ù…Ù†Ø§Ø·Ù‚ Ø§Ù„Ù†Ø´Ø·Ø© ÙˆØ§Ù„ÙÙˆØ² */
.active-zone {
    box-shadow: inset 0 0 15px var(--p1-dim);
    border: 1px solid var(--p1-color);
    background: rgba(255, 158, 100, 0.05);
}
.sub-grid.won { position: relative; }
