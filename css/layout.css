/* =========================================
   ğŸ“ LAYOUT SYSTEM (GRID STABILIZED)
   Ø§Ù„Ù‡ÙŠÙƒÙ„ØŒ Ø§Ù„ØªÙ…Ø±ÙƒØ²ØŒ ÙˆØ§Ù„Ø´Ø¨ÙƒØ© Ø§Ù„ØµØ®Ø±ÙŠØ©
   ========================================= */

body {
    margin: 0; padding: 0;
    width: 100vw; height: 100vh;
    background-color: var(--bg-dark);
    color: var(--text-main);
    font-family: var(--font-ui);
    display: flex; justify-content: center; align-items: center;
    overflow: hidden;
}

/* 1. Ø§Ù„Ø­Ø§ÙˆÙŠØ© Ø§Ù„Ø²Ø¬Ø§Ø¬ÙŠØ© */
.glass-stage {
    position: relative;
    width: 95%; max-width: 1100px;
    height: 90vh;
    background: var(--bg-panel);
    border: 1px solid var(--border-color);
    box-shadow: 0 0 50px rgba(0,0,0,0.6);
    border-radius: 12px;
    overflow: hidden; 
    display: flex; flex-direction: column;
}

/* 2. Ù†Ø¸Ø§Ù… Ø§Ù„Ø·Ø¨Ù‚Ø§Øª */
.screen {
    position: absolute; inset: 0;
    width: 100%; height: 100%;
    background: var(--bg-panel);
    display: flex; flex-direction: column;
    z-index: 10;
    opacity: 0; pointer-events: none;
    transition: opacity 0.3s ease;
    padding: 20px;
    box-sizing: border-box;
}
.screen.active { opacity: 1; pointer-events: all; z-index: 20; }
.center-flex { justify-content: center; align-items: center; text-align: center; }

/* 3. Ø§Ù„Ù†ÙˆØ§ÙØ° Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø© */
.modal-overlay {
    position: fixed; top: 0; left: 0;
    width: 100vw; height: 100vh;
    background: rgba(0, 0, 0, 0.85);
    backdrop-filter: blur(5px);
    z-index: 1000;
    display: flex; justify-content: center; align-items: center;
    opacity: 0; pointer-events: none;
    transition: opacity 0.3s ease;
}
.modal-overlay:not(.hidden) { opacity: 1; pointer-events: all; }

/* 4. ØªØ®Ø·ÙŠØ· Ø³Ø§Ø­Ø© Ø§Ù„Ù„Ø¹Ø¨ ÙˆØ§Ù„Ù‡ÙŠØ¯Ø± */
.game-header {
    width: 100%;
    display: grid;
    grid-template-columns: 1fr 2fr 1fr; /* ØªÙ‚Ø³ÙŠÙ… Ø«Ù„Ø§Ø«ÙŠ Ù…ØªØ³Ø§ÙˆÙŠ */
    align-items: center;
    padding: 0 10px;
    margin-bottom: 5px;
    border-bottom: 1px solid #333;
    background: rgba(0,0,0,0.3);
    min-height: 50px;
}
#btn-back { justify-self: start; }
.turn-display { justify-self: center; text-align: center; width: 100%; }
.score-board { justify-self: end; font-family: var(--font-tech); font-size: 1.2rem; }

.arena-container {
    display: flex; align-items: center; justify-content: center;
    gap: 20px; height: 100%; width: 100%;
}
.side-panel {
    width: 100px; display: flex; flex-direction: column;
    align-items: center; gap: 15px;
}
.grid-wrapper { display: flex; justify-content: center; align-items: center; }

/* 5. Ø§Ù„Ø´Ø¨ÙƒØ© Ø§Ù„ØµØ®Ø±ÙŠØ© (Absolute Positioning Logic) */
.fixed-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    width: var(--arena-size);
    height: var(--arena-size);
    gap: 6px;
    background: #000;
    padding: 6px;
    border-radius: 8px;
    /* Ø£Ø¨Ø¹Ø§Ø¯ Ù…Ù‚Ø¯Ø³Ø© ÙŠÙ…Ù†Ø¹ ØªØºÙŠÙŠØ±Ù‡Ø§ */
    min-width: var(--arena-size);
    max-width: var(--arena-size);
}

.sub-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 1px;
    background: #333; /* Ø®Ø·ÙˆØ· Ø§Ù„Ø´Ø¨ÙƒØ© Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠØ© */
    width: 100%; height: 100%;
    border-radius: 4px; 
    overflow: hidden;
    position: relative;
}

/* Ø§Ù„Ø®Ù„ÙŠØ©: Ù…Ø¬Ø±Ø¯ Ø¥Ø·Ø§Ø± Ù…ÙƒØ§Ù†ÙŠ */
.cell {
    background: #121214;
    position: relative; /* Ù„ØªØ«Ø¨ÙŠØª Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø¯Ø§Ø®Ù„Ù‡ */
    width: 100%; height: 100%;
    cursor: pointer;
    user-select: none;
}
.cell:hover { background: #1f1f25; }

/* Ø§Ù„Ù…Ø­ØªÙˆÙ‰: ÙŠØ·ÙÙˆ ÙÙˆÙ‚ Ø§Ù„Ø®Ù„ÙŠØ© ÙˆÙ„Ø§ ÙŠÙ„Ù…Ø³ Ø­Ø¯ÙˆØ¯Ù‡Ø§ */
.cell img, .cell span {
    position: absolute;
    top: 50%; left: 50%;
    transform: translate(-50%, -50%); /* ØªÙˆØ³ÙŠØ· Ù…Ø·Ù„Ù‚ */
    max-width: 65%; 
    max-height: 65%;
    pointer-events: none;
    display: block;
}
.cell span { font-size: 1.6rem; font-weight: bold; line-height: 1; }

/* Ø§Ù„Ù…Ù†Ø§Ø·Ù‚ Ø§Ù„Ù†Ø´Ø·Ø© ÙˆØ§Ù„ÙÙˆØ² */
.active-zone {
    box-shadow: inset 0 0 15px var(--p1-dim);
    border: 1px solid var(--p1-color);
    background: rgba(255, 158, 100, 0.05);
}

/* Ø·Ø¨Ù‚Ø© Ø§Ù„ÙÙˆØ² Ø¨Ø§Ù„Ù…Ø±Ø¨Ø¹ Ø§Ù„ÙƒØ¨ÙŠØ± */
.win-overlay {
    position: absolute; inset: 0;
    background: rgba(0,0,0,0.9);
    display: flex; align-items: center; justify-content: center;
    z-index: 5;
}

/* Ø´Ø¨ÙƒØ© Ø§Ù„Ø£Ù†Ù…Ø§Ø· */
.modes-grid-layout {
    display: grid; grid-template-columns: 1fr 1fr;
    gap: 15px; width: 100%; max-width: 500px; margin: 0 auto;
}
.mode-card.span-2 { grid-column: span 2; }
